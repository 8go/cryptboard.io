# Безопасность CryprBoard

## Как разботает CryptBoard?

* Данные шифруются на клиенте (в браузере) и расшифрованны могут быть только в браузере, и только правильным получателем.
* Данные передаются через сервер в зашифрованном виде и сервер никак не может их расшифровать
* Авторизация на сервере анонимная, кроме вашего IP-адреса используемого для защиты от DOS-атак никаких данных не требуется
* Обмен публичными ключами шифрования производится через сторонний канал связи

## Как работает шифрование данных в деталях?

* Клиент анонимно авторизуется на сервере и получает uid (уникальный UUID), используемый чтобы ему могли отправлять сообщения
* Используется гибритдный алгоритм шифрования RSA+AES
* Клиент генерирует ассиметричные (публичный и закрытый) ключи RSA
* Вы делитесь публичным ключём с другим пользователем посредством другого канала связи 
    * месенджер
    * пересылка фотографии
    * файловое хранилище
    * электронная почта
    * публикация на вашем сайте
* Закрытый ключ никогда не покидает ваш браузер, никуда не передаётся
* Перед отправкой сообщения, генерируется симметричный AES-ключ и с его помощью шифруются данные  
* Сам AES ключ шифруется с помощью публичного ключа RSA получателя (получатель поделился им с вами заранее)
* Поскольку у вас может быть несколько получателей, для каждого из них сообщение шифруется отдельно
* Чтобы расшифровать данные, нужно расшифровать ключ AES, но для этого нужно иметь закрытый ключ RSA, а он всегда только в вашем браузере.
* Зашифрованные данные отправляются на сервер с указанием uid получателя. Сервер не знает что в сообщении, и никак не сможет узнать
* Получатель, получив сообщение от сервера, расшифровывает своим закрытым ключом RSA полученный в сообщении симметричный ключ AES и с его помощью расшифровывает полезные данные.

## Как я могу доверять?

* Приложение специально сделано максимально простым, JS-файлы не минифицированы и не обфусцированы, чтобы можно было посмотреть код.
* Главный файл приложения main.js легко проанализировать. Поиск слова "private" по нему позволит увидеть что именно делается с закрытым ключём в коде.
* Для шифрования использованы OpenSource библиотеки, в частности, JSEncrypt и forge. Я сам не нестолько крут в криптографии чтобы проанализировать эти библиотеки, 
но предположу что кто-то этоу уже сделал (позже добавлю информацию об этом) 
* Все файлы взяты из официальных репозиториев, ссылки на них размещены на страница <a href='#about'>Информация</a>
* Если какие-то основания доверять моему js-коду у вас есть, до доверять моему backend-серверу вовсе не нужно, так как приложение специально написано так, чтобы 
компроментация сервера не позволяла взломать ваши сообщения
* Чуть позже, когда исходный код будет опубликован в более удобном виде, я подготовлю сборку которую каждый сможет установить на свой сервер, и, тем самым, защититься от гипотетической подмены кода.

## Как обеспечить себе максимальную безопасность используя CryptBoard?

* Когда добавляете новый ключ получателя, сверяйте изображение аватара. Если вы добавляете своё же устройство - просто посмотрите визуально
* Если вы добавляете ключ другого человека, лучше созвонитесь с ним и голосом расскажите какой аватар вы видите. Аватары генерируются на основе sha256-хэша от uid и публичного ключа, при изменении хотя бы одного байта аватар меняется до неузнаваемости
* Также, вы можететакже сверить uid и публичный ключ получателя, что сложнее, но надёжнее.
* Не отправляйте сообщения получателями, публичного ключа которых у вас нет (аватарка с вопросом), по умолчанию это и так отключено. Сообщения таким получателям не шифруются.
* После того как вы закончили работать с сервисом, уничтожте ваши данные нажав на иконку "Череп с костями" в верхей панели или в гамбургер-меню.
* Не используйте устройство которому вы не можете доверять, а если у вас нет выбора, то по крайней мере используйте режим Incognito в браузере, и не забудьте очистить ваши данные

## Какие возможны принципиальные проблемы безопасности

* Man-In-The-Middle: если кто-то даст вам не тот ключ и uid что вы ожидали - он сможет выдавать себя за легитимного получателя. Поэтому проверятей как минимум аватар.
* Подмена кода: теоретически я могу поменять код так чтобы он был менее безопасным. В будущем я опубликую версии для установки на собственном сервере, где вы сами сможете контролировать код.
* Какие-то ошибки или закладки в сторонних библиотеках: Библиотеки шифрования JSEncrypt и Forge, как и любые opensource-бибилотеки могут иметь ошибки и даже закладки позволяющие расшифровывать данные. Здесь мым можем полагаться только на результаты сторонних криптографических анализов этих библиотек 